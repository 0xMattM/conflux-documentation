---
sidebar_position: 6
title: 交易收据
displayed_sidebar: coreSidebar
keywords:
  - 交易
---

交易收据是一个包含有关交易执行结果信息的数据结构。

## 交易收据

收据可以通过RPC方法[`cfx_getTransactionReceipt`](/docs/core/build/json-rpc/cfx-namespace#cfx_gettransactionreceipt)获得。 这个方法将交易哈希作为参数，并在交易未执行时返回`null`，或在执行完成后返回一个收据对象。

## 收据字段

收据包含以下类型的信息：

- 基本交易信息：`transactionHash`, `from`, `to`
- 链上交易信息：`blockHash`、`epochNumber`、`index`
- 交易执行结果：`outcomeStatus` (成功为`0` ,失败为 `1`)
- Gas和存储费用信息：`gasUsed`、`gasFee`、`storageCollateralized`、`gasCoveredBySponsor`、`storageCoveredBySponsor`、`storageReleased`
- 部署合约地址：`contractCreated` (如果是一个部署交易的合约)
- 合约执行日志: `logs`
- 执行错误信息：`txExecErrorMsg` (如果交易执行失败)

如果想了解每个字段的详细信息, 请参阅[`cfx_getTransactionReceipt`](/docs/core/build/json-rpc/cfx-namespace#cfx_gettransactionreceipt)的API文档。

### 日志

The logs field in the Receipt is an array containing all the logs generated during the transaction execution process. When interacting with a contract, the contract can produce logs or events using emit statements. After the transaction is executed, these logs are recorded in the transaction receipt. In Solidity, [Events](https://docs.soliditylang.org/en/v0.8.23/contracts.html#events) are designed to log information about the execution of contract methods, providing detailed information about contract execution through events.

You can retrieve logs using the [cfx_getLogs](/docs/core/build/json-rpc/cfx-namespace#cfx_getlogs) method and decode the log data using the [abi.decode](https://docs.soliditylang.org/en/v0.8.23/contracts.html#events) method. Conflux SDKs also provide methods to help decoding the logs, for example, [javascript](https://docs.confluxnetwork.org/js-conflux-sdk/docs/interact_with_contract#how-to-decode-log) and [python](https://python-conflux-sdk.readthedocs.io/en/latest/examples/05-interact_with_contracts_and_process_logs.html#process-logs).

## Execution Failure

Execution failures can be due to errors that occurred during the contract execution process or errors returned when estimating gas cost through the estimate interface. To find the specific reason for the transaction failure, check the `txExecErrorMsg` under the receipt:

1. `VmError(OutOfGas)`: The transaction specified `gas` is used out during transactioin execution.
2. `VmError(ExceedStorageLimit)`: The transaction specified `storageLimit`(upper-limit storage can be used) is not enough.
3. `NotEnoughCash`: Insufficient user balance to cover transaction cost.
4. `Vm reverted, Reason provided by the contract: xxxx`: The contract execution failed with details provided.
5. `VmError(BadInstruction xxxx)`: Contract deployment failed.
6. `Vm reverted, xxxx`: The contract execution failed with no details provided.

**Solution:** Depending on the specific error message, you may need to increase `gas`, increase `storageLimit`, ensure sufficient balance, or debug the contract code to identify and fix the issues causing the failure.

Remember that when handling transaction errors, it's essential to identify the root cause of the error and apply the appropriate solution. In most cases, modifying transaction parameters, waiting for node synchronization, or debugging the contract code can help resolve the issues.

## 常见问题解答

### What is a transaction receipt, and what information does it contain?

A receipt is the receipt information of a transaction. Through a receipt, you can know some results of the transaction execution, such as whether the transaction is successful, whether a contract is created, gas fee usage, eventLog generated by a transaction execution, etc.

### Why can't I retrieve the receipt for a transaction?

The receipt information for a transaction can only be obtained after the transaction has been successfully executed. If the transaction has not been completed, the receipt will be `null`.

### Can the receipt information for a transaction change?

The receipt information may change immediately after a transaction is executed and included in a block. However, once the transaction is finalized, the receipt information will not change.

### How do I know that a transaction has been successfully executed?

Check the `status` field of the transaction or the `outcomeStatus` field of the receipt to determine whether the transaction is successful, 0 means success and 1 means failure.

### Why would a transaction execution fail?

[Execution Failure](./receipt.md#execution-failure).

### How to know whether a transaction is safe and confirmed?

If the epochNumber of the epoch that the transaction belongs to is less than the currently confirmed epochNumber, it is considered safe.
You can also get the confirmationRisk of the block that the transaction belongs to through the [`cfx_getConfirmationRiskByHash`](/docs/core/build/json-rpc/cfx-namespace/#cfx_getconfirmationriskbyhash) RPC.
If the obtained value is less than 1e-8, it is considered safe.

### How does the status of the transaction change?

After the transaction is submitted through RPC, it will go through several states: Waiting for packaging -> packaging -> execution -> confirmation.

### Why does a transaction keep on waiting to be packaged?

If a transaction has not been packaged for a long time, it’s likely that either the nonce is set incorrectly or the balance is not sufficient.
