"use strict";(self.webpackChunkconflux_docs=self.webpackChunkconflux_docs||[]).push([[9986],{57037:(e,n,c)=>{c.r(n),c.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>f,frontMatter:()=>r,metadata:()=>t,toc:()=>i});var a=c(85893),d=c(11151);const r={id:"trace_rpc",sidebar_position:5,title:"trace \u547d\u540d\u7a7a\u95f4",keywords:["trace-rpc"],displayed_sidebar:"coreSidebar"},s=void 0,t={id:"core/build/json-rpc/trace_rpc",title:"trace \u547d\u540d\u7a7a\u95f4",description:"Through trace RPCs we can know the transaction executive details. To use these RPC Conflux archive node need set two additional config:",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/core/build/json-rpc/trace-namespace.md",sourceDirName:"core/build/json-rpc",slug:"/core/build/json-rpc/trace_rpc",permalink:"/zh-CN/docs/core/build/json-rpc/trace_rpc",draft:!1,unlisted:!1,editUrl:"https://crowdin.com/project/conflux/zh-CN",tags:[],version:"current",sidebarPosition:5,frontMatter:{id:"trace_rpc",sidebar_position:5,title:"trace \u547d\u540d\u7a7a\u95f4",keywords:["trace-rpc"],displayed_sidebar:"coreSidebar"},sidebar:"coreSidebar",previous:{title:"debug Namespace",permalink:"/zh-CN/docs/core/build/json-rpc/debug_rpc"},next:{title:"\u53d1\u5e03/\u8ba2\u9605 API",permalink:"/zh-CN/docs/core/build/json-rpc/pubsub"}},l={},i=[{value:"Trace object",id:"trace-object",level:2},{value:"RPCs",id:"rpcs",level:2},{value:"trace_block",id:"trace_block",level:3},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:4},{value:"Returns",id:"returns",level:4},{value:"TransactionTrace",id:"transactiontrace",level:5},{value:"Returns",id:"returns-1",level:4},{value:"trace_transaction",id:"trace_transaction",level:3},{value:"\u53c2\u6570",id:"\u53c2\u6570-1",level:4},{value:"Returns",id:"returns-2",level:4},{value:"trace_epoch",id:"trace_epoch",level:3},{value:"\u53c2\u6570",id:"\u53c2\u6570-2",level:4},{value:"Returns",id:"returns-3",level:4},{value:"trace_filter",id:"trace_filter",level:3},{value:"\u53c2\u6570",id:"\u53c2\u6570-3",level:4},{value:"Returns",id:"returns-4",level:4},{value:"Note",id:"note",level:2},{value:"V2.0 trace breaking change",id:"v20-trace-breaking-change",level:2},{value:"New added field <code>valid</code>",id:"new-added-field-valid",level:3},{value:"Gas consume and refund trace was introduced",id:"gas-consume-and-refund-trace-was-introduced",level:3},{value:"Trace for storage collateral.",id:"trace-for-storage-collateral",level:3},{value:"Indicator for kill contract",id:"indicator-for-kill-contract",level:3},{value:"New added <code>space</code> field",id:"new-added-space-field",level:3},{value:"Four new field added to <code>internal_transfer_action</code>",id:"four-new-field-added-to-internal_transfer_action",level:3},{value:"Specification for pocket",id:"specification-for-pocket",level:4},{value:"Specification for space",id:"specification-for-space",level:4},{value:"Changes in integrity constraints",id:"changes-in-integrity-constraints",level:3},{value:"Before change",id:"before-change",level:4},{value:"After change",id:"after-change",level:4}];function o(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["Through ",(0,a.jsx)(n.code,{children:"trace"})," RPCs we can know the transaction executive details. To use these RPC Conflux archive node need set two additional config:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-toml",children:'executive_trace = true\npublic_rpc_apis = "safe,trace"  // or public_rpc_apis = "all"\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Note: An existing archive node need clear all blockchain data to open ",(0,a.jsx)(n.code,{children:"executive_trace"})," config."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Note"}),": From Conflux-rust v2.0 trace RPC have some breaking change, ",(0,a.jsx)(n.a,{href:"#v20-trace-breaking-change",children:"Read below"})," for details."]}),"\n",(0,a.jsx)(n.h2,{id:"trace-object",children:"Trace object"}),"\n",(0,a.jsxs)(n.p,{children:["A ",(0,a.jsx)(n.code,{children:"Trace"})," trace object contain below field:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"type"}),": ",(0,a.jsx)(n.code,{children:"STRING"})," - Type of trace. Avaliable value is ",(0,a.jsx)(n.code,{children:"call"}),", ",(0,a.jsx)(n.code,{children:"create"}),", ",(0,a.jsx)(n.code,{children:"call_result"}),", ",(0,a.jsx)(n.code,{children:"create_result"}),", ",(0,a.jsx)(n.code,{children:"internal_transfer_action"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"action"}),": ",(0,a.jsx)(n.code,{children:"OBJECT"})," - Trace's action info\uff0cdifferent type trace's action have different fields."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"\u4f8b\u5982:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "action": {\n    "callType": "call",\n    "from": "CFXTEST:TYPE.USER:AAJSUKECFVZF2MG8GZYR9GNAKZYSX9P6VU29DWZ6T2",\n    "gas": "0x171e2",\n    "input": "0x9c312cfd",\n    "to": "CFXTEST:TYPE.CONTRACT:ACE8BSDS7WN52KHYK29NEBZWFPVZ5RPPD28KCXETJ8",\n    "value": "0x1d6e3"\n  },\n  "type": "call"\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Check this ",(0,a.jsx)(n.a,{href:"https://github.com/Conflux-Chain/conflux-doc/blob/master/docs/trace_introduction.md",children:"document"})," to get detail explanation of Conflux trace"]}),"\n",(0,a.jsx)(n.h2,{id:"rpcs",children:"RPCs"}),"\n",(0,a.jsx)(n.h3,{id:"trace_block",children:"trace_block"}),"\n",(0,a.jsx)(n.p,{children:"Get block traces by block hash"}),"\n",(0,a.jsx)(n.h4,{id:"\u53c2\u6570",children:"\u53c2\u6570"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"DATA, 32 Bytes - hash of a block"}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"returns",children:"Returns"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"blockHash"}),": ",(0,a.jsx)(n.code,{children:"HASH"})," - Hash of block"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"epochHash"}),": ",(0,a.jsx)(n.code,{children:"HASH"})," - Hash of epoch"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"epochNumber"}),": ",(0,a.jsx)(n.code,{children:"QUANTITY"})," - Number of epoch"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"transactionTraces"}),": ",(0,a.jsx)(n.code,{children:"Array"})," -  Array of ",(0,a.jsx)(n.code,{children:"TransactionTrace"})," info"]}),"\n"]}),"\n",(0,a.jsx)(n.h5,{id:"transactiontrace",children:"TransactionTrace"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"transactionHash"}),": ",(0,a.jsx)(n.code,{children:"HASH"})," - Hash of transaction"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"transactionPosition"}),": ",(0,a.jsx)(n.code,{children:"QUANTITY"})," - Position of transaction in block"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"traces"}),": ",(0,a.jsx)(n.code,{children:"Array"})," - Array of ",(0,a.jsx)(n.code,{children:"Trace"})]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'// Request\ncurl --location --request POST \'http://testnet-rpc:12537\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \' {\n    "jsonrpc": "2.0",\n    "id": "15922956697249514502",\n    "method": "trace_block",\n    "params": ["0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369"]\n  }\'\n\n// Response\n{\n    "jsonrpc": "2.0",\n    "result": {\n        "blockHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n        "epochHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n        "epochNumber": "0x28968d0",\n        "transactionTraces": [\n            {\n                "traces": [\n                    {\n                        "action": {\n                            "callType": "call",\n                            "from": "CFXTEST:TYPE.USER:AAJSUKECFVZF2MG8GZYR9GNAKZYSX9P6VU29DWZ6T2",\n                            "gas": "0x171e2",\n                            "input": "0x9c312cfd",\n                            "to": "CFXTEST:TYPE.CONTRACT:ACE8BSDS7WN52KHYK29NEBZWFPVZ5RPPD28KCXETJ8",\n                            "value": "0x1d6e3"\n                        },\n                        "type": "call"\n                    },\n                    {\n                        "action": {\n                            "callType": "call",\n                            "from": "CFXTEST:TYPE.CONTRACT:ACE8BSDS7WN52KHYK29NEBZWFPVZ5RPPD28KCXETJ8",\n                            "gas": "0x14ac7",\n                            "input": "0xb281a7bd00000000000000000000000089e0b86eec97bc24f44e3eb206b22b235db58c1e",\n                            "to": "CFXTEST:TYPE.CONTRACT:ACFNPY71HJHAMY075XYPS56124ZJE5154UX9NTE7VT",\n                            "value": "0x1d6e3"\n                        },\n                        "type": "call"\n                    },\n                    {\n                        "action": {\n                            "callType": "delegatecall",\n                            "from": "CFXTEST:TYPE.CONTRACT:ACFNPY71HJHAMY075XYPS56124ZJE5154UX9NTE7VT",\n                            "gas": "0x14157",\n                            "input": "0xb281a7bd00000000000000000000000089e0b86eec97bc24f44e3eb206b22b235db58c1e",\n                            "to": "CFXTEST:TYPE.CONTRACT:ACEMTZA4ZJN1FCUTZWN6P8EKDBF2X8DCZY4TEESNH8",\n                            "value": "0x1d6e3"\n                        },\n                        "type": "call"\n                    },\n                    {\n                        "action": {\n                            "callType": "staticcall",\n                            "from": "CFXTEST:TYPE.CONTRACT:ACFNPY71HJHAMY075XYPS56124ZJE5154UX9NTE7VT",\n                            "gas": "0x13464",\n                            "input": "0xf0940002",\n                            "to": "CFXTEST:TYPE.CONTRACT:ACE8BSDS7WN52KHYK29NEBZWFPVZ5RPPD28KCXETJ8",\n                            "value": "0x0"\n                        },\n                        "type": "call"\n                    },\n                    {\n                        "action": {\n                            "gasLeft": "0x11ae8",\n                            "outcome": "success",\n                            "returnData": "0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001f00adf0308dce89889061254123a68747470733a2f2f6170692e62696e616e63652e636f6d2f6170692f76332f7469636b65722f70726963653f73796d626f6c3d434658555344541a168418778218646570726963658218571a000f4240185b1257123668747470733a2f2f7777772e6f6b65782e636f6d2f6170692f696e6465782f76332f4346582d5553442f636f6e7374697475656e74731a1d8518778218666464617461821864646c6173748218571a000f4240185b1247122e68747470733a2f2f646174612e676174656170692e696f2f617069322f312f7469636b65722f6366785f757364741a15841877821864646c6173748218571a000f4240185b1264123d68747470733a2f2f7777772e6d78632e636f6d2f6f70656e2f6170692f76322f6d61726b65742f7469636b65723f73796d626f6c3d4346585f555344541a23871877821861646461746182181800821867646c61737418728218571a000f4240185b125b123568747470733a2f2f6170692e626b65782e63632f76322f712f7469636b65722f70726963653f73796d626f6c3d4346585f555344541a228618778218616464617461821818008218646570726963658218571a000f4240185b1a0d0a0908051205fa3fc000001003220d0a0908051205fa3fc000001003100a186420012846308094ebdc0300000000000000000000000000000000"\n                        },\n                        "type": "call_result"\n                    },\n                    {\n                        "action": {\n                            "callType": "staticcall",\n                            "from": "CFXTEST:TYPE.CONTRACT:ACFNPY71HJHAMY075XYPS56124ZJE5154UX9NTE7VT",\n                            "gas": "0xce86",\n                            "input": "0x0adf0308dce89889061254123a68747470733a2f2f6170692e62696e616e63652e636f6d2f6170692f76332f7469636b65722f70726963653f73796d626f6c3d434658555344541a168418778218646570726963658218571a000f4240185b1257123668747470733a2f2f7777772e6f6b65782e636f6d2f6170692f696e6465782f76332f4346582d5553442f636f6e7374697475656e74731a1d8518778218666464617461821864646c6173748218571a000f4240185b1247122e68747470733a2f2f646174612e676174656170692e696f2f617069322f312f7469636b65722f6366785f757364741a15841877821864646c6173748218571a000f4240185b1264123d68747470733a2f2f7777772e6d78632e636f6d2f6f70656e2f6170692f76322f6d61726b65742f7469636b65723f73796d626f6c3d4346585f555344541a23871877821861646461746182181800821867646c61737418728218571a000f4240185b125b123568747470733a2f2f6170692e626b65782e63632f76322f712f7469636b65722f70726963653f73796d626f6c3d4346585f555344541a228618778218616464617461821818008218646570726963658218571a000f4240185b1a0d0a0908051205fa3fc000001003220d0a0908051205fa3fc000001003100a186420012846308094ebdc03",\n                            "to": "CFXTEST:TYPE.BUILTIN:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJK7B54454",\n                            "value": "0x0"\n                        },\n                        "type": "call"\n                    },\n                    {\n                        "action": {\n                            "gasLeft": "0xcd8a",\n                            "outcome": "success",\n                            "returnData": "0xdccb9be50637c331c1c66ef1b0c2779f0a1893661c017c530b641dcec02010dc"\n                        },\n                        "type": "call_result"\n                    },\n                    {\n                        "action": {\n                            "gasLeft": "0x8fe9",\n                            "outcome": "success",\n                            "returnData": "0x0000000000000000000000000000000000000000000000000000000000001662"\n                        },\n                        "type": "call_result"\n                    },\n                    {\n                        "action": {\n                            "gasLeft": "0x94d5",\n                            "outcome": "success",\n                            "returnData": "0x0000000000000000000000000000000000000000000000000000000000001662"\n                        },\n                        "type": "call_result"\n                    },\n                    {\n                        "action": {\n                            "gasLeft": "0x713e",\n                            "outcome": "success",\n                            "returnData": "0x"\n                        },\n                        "type": "call_result"\n                    }\n                ],\n                "transactionHash": "0x8437fd07e33ffaff9dc1b360cb8b0450847b15a164059b50736c65762e6629ad",\n                "transactionPosition": "0x0"\n            }\n        ]\n    },\n    "id": "15922956697249514502"\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"returns-1",children:"Returns"}),"\n",(0,a.jsx)(n.h3,{id:"trace_transaction",children:"trace_transaction"}),"\n",(0,a.jsx)(n.p,{children:"Get transaction's trace by it's hash"}),"\n",(0,a.jsx)(n.h4,{id:"\u53c2\u6570-1",children:"\u53c2\u6570"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"DATA, 32 Bytes - hash of a transaction"}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"returns-2",children:"Returns"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"type"}),": ",(0,a.jsx)(n.code,{children:"string"})," - Avaliable value is ",(0,a.jsx)(n.code,{children:"call"}),", ",(0,a.jsx)(n.code,{children:"create"}),", ",(0,a.jsx)(n.code,{children:"call_result"}),", ",(0,a.jsx)(n.code,{children:"create_result"}),", ",(0,a.jsx)(n.code,{children:"internal_transfer_action"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"transactionPosition"}),": ",(0,a.jsx)(n.code,{children:"QUANTITY"})," - Position of transaction in block"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"transactionHash"}),": ",(0,a.jsx)(n.code,{children:"HASH"})," - Hash of transaction"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"epochNumber"}),": ",(0,a.jsx)(n.code,{children:"QUANTITY"})," - Number of epoch"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"epochHash"}),": ",(0,a.jsx)(n.code,{children:"HASH"})," - Hash of epoch"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"blockHash"}),": ",(0,a.jsx)(n.code,{children:"HASH"})," - Hash of block"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"action"}),": ",(0,a.jsx)(n.code,{children:"OBJECT"})," - Trace info"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'// Request\ncurl --location --request POST \'http://testnet-rpc:12537\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \' {\n    "jsonrpc": "2.0",\n    "id": "15922956697249514502",\n    "method": "trace_transaction",\n    "params": ["0x8437fd07e33ffaff9dc1b360cb8b0450847b15a164059b50736c65762e6629ad"]\n  }\'\n\n// Response\n{\n    "jsonrpc": "2.0",\n    "result": [\n        {\n            "action": {\n                "callType": "call",\n                "from": "CFXTEST:TYPE.USER:AAJSUKECFVZF2MG8GZYR9GNAKZYSX9P6VU29DWZ6T2",\n                "gas": "0x171e2",\n                "input": "0x9c312cfd",\n                "to": "CFXTEST:TYPE.CONTRACT:ACE8BSDS7WN52KHYK29NEBZWFPVZ5RPPD28KCXETJ8",\n                "value": "0x1d6e3"\n            },\n            "blockHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochNumber": "0x28968d0",\n            "transactionHash": "0x8437fd07e33ffaff9dc1b360cb8b0450847b15a164059b50736c65762e6629ad",\n            "transactionPosition": "0x0",\n            "type": "call"\n        },\n        {\n            "action": {\n                "callType": "call",\n                "from": "CFXTEST:TYPE.CONTRACT:ACE8BSDS7WN52KHYK29NEBZWFPVZ5RPPD28KCXETJ8",\n                "gas": "0x14ac7",\n                "input": "0xb281a7bd00000000000000000000000089e0b86eec97bc24f44e3eb206b22b235db58c1e",\n                "to": "CFXTEST:TYPE.CONTRACT:ACFNPY71HJHAMY075XYPS56124ZJE5154UX9NTE7VT",\n                "value": "0x1d6e3"\n            },\n            "blockHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochNumber": "0x28968d0",\n            "transactionHash": "0x8437fd07e33ffaff9dc1b360cb8b0450847b15a164059b50736c65762e6629ad",\n            "transactionPosition": "0x0",\n            "type": "call"\n        },\n        {\n            "action": {\n                "callType": "delegatecall",\n                "from": "CFXTEST:TYPE.CONTRACT:ACFNPY71HJHAMY075XYPS56124ZJE5154UX9NTE7VT",\n                "gas": "0x14157",\n                "input": "0xb281a7bd00000000000000000000000089e0b86eec97bc24f44e3eb206b22b235db58c1e",\n                "to": "CFXTEST:TYPE.CONTRACT:ACEMTZA4ZJN1FCUTZWN6P8EKDBF2X8DCZY4TEESNH8",\n                "value": "0x1d6e3"\n            },\n            "blockHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochNumber": "0x28968d0",\n            "transactionHash": "0x8437fd07e33ffaff9dc1b360cb8b0450847b15a164059b50736c65762e6629ad",\n            "transactionPosition": "0x0",\n            "type": "call"\n        },\n        {\n            "action": {\n                "callType": "staticcall",\n                "from": "CFXTEST:TYPE.CONTRACT:ACFNPY71HJHAMY075XYPS56124ZJE5154UX9NTE7VT",\n                "gas": "0x13464",\n                "input": "0xf0940002",\n                "to": "CFXTEST:TYPE.CONTRACT:ACE8BSDS7WN52KHYK29NEBZWFPVZ5RPPD28KCXETJ8",\n                "value": "0x0"\n            },\n            "blockHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochNumber": "0x28968d0",\n            "transactionHash": "0x8437fd07e33ffaff9dc1b360cb8b0450847b15a164059b50736c65762e6629ad",\n            "transactionPosition": "0x0",\n            "type": "call"\n        },\n        {\n            "action": {\n                "gasLeft": "0x11ae8",\n                "outcome": "success",\n                "returnData": "0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001f00adf0308dce89889061254123a68747470733a2f2f6170692e62696e616e63652e636f6d2f6170692f76332f7469636b65722f70726963653f73796d626f6c3d434658555344541a168418778218646570726963658218571a000f4240185b1257123668747470733a2f2f7777772e6f6b65782e636f6d2f6170692f696e6465782f76332f4346582d5553442f636f6e7374697475656e74731a1d8518778218666464617461821864646c6173748218571a000f4240185b1247122e68747470733a2f2f646174612e676174656170692e696f2f617069322f312f7469636b65722f6366785f757364741a15841877821864646c6173748218571a000f4240185b1264123d68747470733a2f2f7777772e6d78632e636f6d2f6f70656e2f6170692f76322f6d61726b65742f7469636b65723f73796d626f6c3d4346585f555344541a23871877821861646461746182181800821867646c61737418728218571a000f4240185b125b123568747470733a2f2f6170692e626b65782e63632f76322f712f7469636b65722f70726963653f73796d626f6c3d4346585f555344541a228618778218616464617461821818008218646570726963658218571a000f4240185b1a0d0a0908051205fa3fc000001003220d0a0908051205fa3fc000001003100a186420012846308094ebdc0300000000000000000000000000000000"\n            },\n            "blockHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochNumber": "0x28968d0",\n            "transactionHash": "0x8437fd07e33ffaff9dc1b360cb8b0450847b15a164059b50736c65762e6629ad",\n            "transactionPosition": "0x0",\n            "type": "call_result"\n        },\n        {\n            "action": {\n                "callType": "staticcall",\n                "from": "CFXTEST:TYPE.CONTRACT:ACFNPY71HJHAMY075XYPS56124ZJE5154UX9NTE7VT",\n                "gas": "0xce86",\n                "input": "0x0adf0308dce89889061254123a68747470733a2f2f6170692e62696e616e63652e636f6d2f6170692f76332f7469636b65722f70726963653f73796d626f6c3d434658555344541a168418778218646570726963658218571a000f4240185b1257123668747470733a2f2f7777772e6f6b65782e636f6d2f6170692f696e6465782f76332f4346582d5553442f636f6e7374697475656e74731a1d8518778218666464617461821864646c6173748218571a000f4240185b1247122e68747470733a2f2f646174612e676174656170692e696f2f617069322f312f7469636b65722f6366785f757364741a15841877821864646c6173748218571a000f4240185b1264123d68747470733a2f2f7777772e6d78632e636f6d2f6f70656e2f6170692f76322f6d61726b65742f7469636b65723f73796d626f6c3d4346585f555344541a23871877821861646461746182181800821867646c61737418728218571a000f4240185b125b123568747470733a2f2f6170692e626b65782e63632f76322f712f7469636b65722f70726963653f73796d626f6c3d4346585f555344541a228618778218616464617461821818008218646570726963658218571a000f4240185b1a0d0a0908051205fa3fc000001003220d0a0908051205fa3fc000001003100a186420012846308094ebdc03",\n                "to": "CFXTEST:TYPE.BUILTIN:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJK7B54454",\n                "value": "0x0"\n            },\n            "blockHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochNumber": "0x28968d0",\n            "transactionHash": "0x8437fd07e33ffaff9dc1b360cb8b0450847b15a164059b50736c65762e6629ad",\n            "transactionPosition": "0x0",\n            "type": "call"\n        },\n        {\n            "action": {\n                "gasLeft": "0xcd8a",\n                "outcome": "success",\n                "returnData": "0xdccb9be50637c331c1c66ef1b0c2779f0a1893661c017c530b641dcec02010dc"\n            },\n            "blockHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochNumber": "0x28968d0",\n            "transactionHash": "0x8437fd07e33ffaff9dc1b360cb8b0450847b15a164059b50736c65762e6629ad",\n            "transactionPosition": "0x0",\n            "type": "call_result"\n        },\n        {\n            "action": {\n                "gasLeft": "0x8fe9",\n                "outcome": "success",\n                "returnData": "0x0000000000000000000000000000000000000000000000000000000000001662"\n            },\n            "blockHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochNumber": "0x28968d0",\n            "transactionHash": "0x8437fd07e33ffaff9dc1b360cb8b0450847b15a164059b50736c65762e6629ad",\n            "transactionPosition": "0x0",\n            "type": "call_result"\n        },\n        {\n            "action": {\n                "gasLeft": "0x94d5",\n                "outcome": "success",\n                "returnData": "0x0000000000000000000000000000000000000000000000000000000000001662"\n            },\n            "blockHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochNumber": "0x28968d0",\n            "transactionHash": "0x8437fd07e33ffaff9dc1b360cb8b0450847b15a164059b50736c65762e6629ad",\n            "transactionPosition": "0x0",\n            "type": "call_result"\n        },\n        {\n            "action": {\n                "gasLeft": "0x713e",\n                "outcome": "success",\n                "returnData": "0x"\n            },\n            "blockHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochHash": "0x4c4db64db7ddaf4fd6c9d0eb5398d4c7838252ceaefdfb6b1be27aa301428369",\n            "epochNumber": "0x28968d0",\n            "transactionHash": "0x8437fd07e33ffaff9dc1b360cb8b0450847b15a164059b50736c65762e6629ad",\n            "transactionPosition": "0x0",\n            "type": "call_result"\n        }\n    ],\n    "id": "15922956697249514502"\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"trace_epoch",children:"trace_epoch"}),"\n",(0,a.jsx)(n.p,{children:"Get whole epoch transaction's trace by it's number"}),"\n",(0,a.jsx)(n.h4,{id:"\u53c2\u6570-2",children:"\u53c2\u6570"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"QUANTITY|TAG"})," - the epoch number, or the string ",(0,a.jsx)(n.code,{children:'"latest_mined"'}),", ",(0,a.jsx)(n.code,{children:'"latest_state"'}),", ",(0,a.jsx)(n.code,{children:'"latest_confirmed"'}),", ",(0,a.jsx)(n.code,{children:'"latest_checkpoint"'})," or ",(0,a.jsx)(n.code,{children:'"earliest"'}),", see the ",(0,a.jsx)(n.a,{href:"#the-default-epochnumber-parameter",children:"epoch number parameter"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"returns-3",children:"Returns"}),"\n",(0,a.jsx)(n.p,{children:"TODO"}),"\n",(0,a.jsx)(n.h3,{id:"trace_filter",children:"trace_filter"}),"\n",(0,a.jsx)(n.p,{children:"Returns all traces matching the provided filter."}),"\n",(0,a.jsx)(n.h4,{id:"\u53c2\u6570-3",children:"\u53c2\u6570"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Object"})," - A trace filter object:","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"fromEpoch"}),": ",(0,a.jsx)(n.code,{children:"QUANTITY|TAG"})," - (optional) the epoch number, or the string ",(0,a.jsx)(n.code,{children:'"latest_state"'}),", ",(0,a.jsx)(n.code,{children:'"latest_confirmed"'}),", ",(0,a.jsx)(n.code,{children:'"latest_checkpoint"'})," or ",(0,a.jsx)(n.code,{children:'"earliest"'}),", see the ",(0,a.jsx)(n.a,{href:"#the-default-epochnumber-parameter",children:"epoch number parameter"})," Search will be applied from this epoch number."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"toEpoch"}),": ",(0,a.jsx)(n.code,{children:"QUANTITY|TAG"})," - (optional) the epoch number, or the string ",(0,a.jsx)(n.code,{children:'"latest_state"'}),", ",(0,a.jsx)(n.code,{children:'"latest_confirmed"'}),", ",(0,a.jsx)(n.code,{children:'"latest_checkpoint"'})," or ",(0,a.jsx)(n.code,{children:'"earliest"'}),", see the ",(0,a.jsx)(n.a,{href:"#the-default-epochnumber-parameter",children:"epoch number parameter"}),". Search will be applied up until (and including) this epoch number."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"fromAddress"}),": ",(0,a.jsx)(n.code,{children:"BASE32"})," - (optional)."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"toAddres"}),": ",(0,a.jsx)(n.code,{children:"BASE32"})," - (optional)."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"blockHashes"}),": ",(0,a.jsx)(n.code,{children:"Array"})," of ",(0,a.jsx)(n.code,{children:"DATA"})," - (optional, default: ",(0,a.jsx)(n.code,{children:"null"}),") Array of up to 128 block hashes that the search will be applied to. This will override from/to epoch fields if it's not ",(0,a.jsx)(n.code,{children:"null"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"actionTypes"}),": ",(0,a.jsx)(n.code,{children:"Array"})," of action type enum - (optional) If None, match all. If specified, trace must match one of these action types."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"after"}),": ",(0,a.jsx)(n.code,{children:"QUANTITY"})," - (optional) The offset trace number."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"count"}),": ",(0,a.jsx)(n.code,{children:"QUANTITY"})," - (optional) The number of traces to display in a batch."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"returns-4",children:"Returns"}),"\n",(0,a.jsxs)(n.p,{children:["Same as ",(0,a.jsx)(n.code,{children:"trace_transaction"})]}),"\n",(0,a.jsx)(n.h2,{id:"note",children:"Note"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["One ",(0,a.jsx)(n.code,{children:"call"})," trace, will have one corresponding ",(0,a.jsx)(n.code,{children:"call_result"})," trace. A ",(0,a.jsx)(n.code,{children:"create"})," trace will also have one corresponding ",(0,a.jsx)(n.code,{children:"create_result"})," trace"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"call"})," trace's ",(0,a.jsx)(n.code,{children:"result"})," field have three possible value: ",(0,a.jsx)(n.code,{children:"success"}),", ",(0,a.jsx)(n.code,{children:"fail"}),", ",(0,a.jsx)(n.code,{children:"revert"})]}),"\n",(0,a.jsxs)(n.li,{children:["Only traces which's ",(0,a.jsx)(n.code,{children:"callType"})," value is ",(0,a.jsx)(n.code,{children:"call"})," and have ",(0,a.jsx)(n.code,{children:"success"})," result status, that can indicate CFX transfer"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"v20-trace-breaking-change",children:"V2.0 trace breaking change"}),"\n",(0,a.jsxs)(n.p,{children:["From Conflux-rust v2.0 the trace RPC have imported some breaking change, below is a quick introduction of the updates, there also is ",(0,a.jsx)(n.a,{href:"https://github.com/Conflux-Chain/CIPs/issues/88",children:"detail document here"})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Note: To use the new trace data, the fullnode data should be cleaned and resynchronization."})}),"\n",(0,a.jsxs)(n.h3,{id:"new-added-field-valid",children:["New added field ",(0,a.jsx)(n.code,{children:"valid"})]}),"\n",(0,a.jsxs)(n.p,{children:["A new field ",(0,a.jsx)(n.code,{children:"valid"})," is added to trace to indicate whether the corresponding trace is reverted."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsxs)(n.strong,{children:["Note: If the old trace data is not cleaned and resynchronization, the ",(0,a.jsx)(n.code,{children:"valid"})," filed will always be true."]})}),"\n",(0,a.jsx)(n.h3,{id:"gas-consume-and-refund-trace-was-introduced",children:"Gas consume and refund trace was introduced"}),"\n",(0,a.jsx)(n.p,{children:'Any transaction bumping nonce during execution will generate one or two traces with type "internal_transfer_action" to indicate gas payment and gas refund.'}),"\n",(0,a.jsx)(n.p,{children:"Consider a transaction has gas limit 40000 and gas price 3 Drip."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n    "action": {\n        "from": <contract_address>,\n        "fromPocket": "sponsor_balance_for_gas",\n        "to": <zero_address>,\n        "toPocket": "gas_payment",\n        "value": 120000, \n    }\n    "type": "internal_transfer_action"\n    ......\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"If the transaction is not sponsored, the trace will be"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n    "action": {\n        "from": <sender_address>,\n        "fromPocket": "balance",\n        "to": <zero_address>,\n        "toPocket": "gas_payment",\n        "value": 120000, \n    }\n    "type": "internal_transfer_action"\n    ......\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"This should be the first trace of most transactions."}),"\n",(0,a.jsx)(n.p,{children:"After execution, if this transaction costs 25000 gas, up to 1/4 of gas limit, i.e., 10000 gas (30000 Drip when gas price = 3) will be refunded, then it will generate a trace"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n    "action": {\n        "from": <zero_address>,\n        "fromPocket": "gas_payment",\n        "to": ...,\n        "toPocket": ...,\n        "value": 30000, \n    },\n    "type": "internal_transfer_action",\n    ...\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"trace-for-storage-collateral",children:"Trace for storage collateral."}),"\n",(0,a.jsx)(n.p,{children:"Consider a transaction collateralize 10 Drip (it can not happen in a real Conflux system, just for example)."}),"\n",(0,a.jsx)(n.p,{children:"If the transaction is sponsored,"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n    "action": {\n        "from": <contract_address>,\n        "fromPocket": "sponsor_balance_for_collateral",\n        "to": <contract_address>,\n        "toPocket": "storage_collateral",\n        "value": 10, \n    },\n    "type": "internal_transfer_action",\n    ...\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"If the transaction is not sponsored,"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n    "action": {\n        "from": <sender_address>,\n        "fromPocket": "balance",\n        "to": <sender_address>,\n        "toPocket": "storage_collateral",\n        "value": 10, \n    },\n    "type": "internal_transfer_action",\n    ...\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"When releasing storage, the value will be returned to the same route."}),"\n",(0,a.jsx)(n.h3,{id:"indicator-for-kill-contract",children:"Indicator for kill contract"}),"\n",(0,a.jsx)(n.p,{children:"Each time a contract is killed, it will produce such a trace,"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n    "action": {\n        "from": <contract_address>,\n        "fromPocket": "balance",\n        "to": <zero_address>, \n        "toPocket": "mint_burn",\n        "value": ...,\n        ...\n    },\n    "type": "internal_transfer_action",\n    ...\n}\n'})}),"\n",(0,a.jsxs)(n.h3,{id:"new-added-space-field",children:["New added ",(0,a.jsx)(n.code,{children:"space"})," field"]}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"call"})," and ",(0,a.jsx)(n.code,{children:"create"})," type action will add a new field ",(0,a.jsx)(n.code,{children:"space"})," indicate wich space the trace is occured, the possible value are:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"native"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"ethereum"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"none"})}),"\n"]}),"\n",(0,a.jsxs)(n.h3,{id:"four-new-field-added-to-internal_transfer_action",children:["Four new field added to ",(0,a.jsx)(n.code,{children:"internal_transfer_action"})]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"fromPocket"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"toPocket"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"fromSpace"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"toSpace"})}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"specification-for-pocket",children:"Specification for pocket"}),"\n",(0,a.jsx)(n.p,{children:"In Conflux, each account could have several pockets to store CFX."}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"balance"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"staking_balance"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"storage_collateral"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"sponsor_balance_for_gas"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"sponsor_balance_for_collateral"})}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"The fromPocket field and toPocket field could be one of them."}),"\n",(0,a.jsxs)(n.p,{children:['Besides these five values, the "pocket" could be two special values ',(0,a.jsx)(n.code,{children:"mint_burn"})," and ",(0,a.jsx)(n.code,{children:"gas_payment"}),"."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["fromPocket = ",(0,a.jsx)(n.code,{children:"mint_burn"}),": mint CFX, e.g., generate staking interest"]}),"\n",(0,a.jsxs)(n.li,{children:["toPocket = ",(0,a.jsx)(n.code,{children:"mint_burn"}),": burn CFX, e.g., when a contract is killed, its staking balance will be burnt."]}),"\n",(0,a.jsxs)(n.li,{children:["fromPocket = ",(0,a.jsx)(n.code,{children:"gas_payment"}),": gas payment, usually equals to gas_price * gas_limit"]}),"\n",(0,a.jsxs)(n.li,{children:["toPocket = ",(0,a.jsx)(n.code,{children:"gas_payment"}),": gas refund after transaction execution."]}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"specification-for-space",children:"Specification for space"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"native"}),"\n",(0,a.jsx)(n.li,{children:"evm"}),"\n",(0,a.jsx)(n.li,{children:"none"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"changes-in-integrity-constraints",children:"Changes in integrity constraints"}),"\n",(0,a.jsx)(n.h4,{id:"before-change",children:"Before change"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:'The balance increasing (or decreasing) of an address (except the internal contract) during transaction execution corresponds to a trace whose "to" (or "from") is this address.'}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"after-change",children:"After change"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:'The balance increasing (or decreasing) of an address (all the address) during transaction execution corresponds to a trace whose "to" (or "from") is this address and "toPocket" (or "fromPocket") is "balance". (Note: for trace type except "interal_transfer_action", the "fromPocket" and "toPocket" equal to "balance" implicitly.)'}),"\n",(0,a.jsx)(n.li,{children:'The staking balance/collateral balance/sponsor balance for gas/sponsor balance for collateral increasing (or decreasing) of an address during transaction execution corresponds to an internal_transfer type trace whose "to" (or "from") is this address and "toPocket" (or "fromPocket") is "sponsor_balance"/"storage_collateral"/"sponsor_balance_for_gas"/"sponsor_balance_for_collateral".'}),"\n"]})]})}function f(e={}){const{wrapper:n}={...(0,d.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},11151:(e,n,c)=>{c.d(n,{Z:()=>t,a:()=>s});var a=c(67294);const d={},r=a.createContext(d);function s(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:s(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);