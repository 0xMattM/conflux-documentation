"use strict";(self.webpackChunkconflux_docs=self.webpackChunkconflux_docs||[]).push([[3073],{45872:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var r=t(85893),i=t(11151);const o={displayed_sidebar:"generalSidebar"},a="\u4f4d\u56fe\u548c\u4f4d\u8fd0\u7b97",s={id:"general/build/smart-contracts/gas-optimization/bitmap",title:"\u4f4d\u56fe\u548c\u4f4d\u8fd0\u7b97",description:"\u5728\u533a\u5757\u94fe\u4e0a\u5b58\u50a8\u6570\u636e\u7684\u6210\u672c\u6781\u9ad8\u3002 \u5f88\u591a\u9879\u76ee\u521b\u65b0\u6027\u5730\u4f7f\u7528\u4e86\u4e00\u4e9b\u5de7\u5999\u7684\u65b9\u6cd5\u6765\u964d\u4f4egas\u8d39\u7528\u3002 \u6211\u4eec\u4eca\u5929\u5c06\u4f1a\u8ba8\u8bba\u90a3\u4e9b\u5e38\u89c1\u4e8e\u9f99\u5934\u9879\u76ee\u7684\u6e90\u4ee3\u7801\u4e2d\u7684\u65b9\u6cd5\u3002",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/general/build/smart-contracts/gas-optimization/bitmap.md",sourceDirName:"general/build/smart-contracts/gas-optimization",slug:"/general/build/smart-contracts/gas-optimization/bitmap",permalink:"/zh-CN/docs/general/build/smart-contracts/gas-optimization/bitmap",draft:!1,unlisted:!1,editUrl:"https://crowdin.com/project/conflux/zh-CN",tags:[],version:"current",frontMatter:{displayed_sidebar:"generalSidebar"},sidebar:"generalSidebar",previous:{title:"Comparison Operators",permalink:"/zh-CN/docs/general/build/smart-contracts/gas-optimization/LessThan"},next:{title:"Clone vs New/Create2",permalink:"/zh-CN/docs/general/build/smart-contracts/gas-optimization/clone"}},c={},d=[{value:"Gas\u4f18\u5316\u5efa\u8bae\uff1a",id:"gas\u4f18\u5316\u5efa\u8bae",level:3}];function l(n){const e={code:"code",h1:"h1",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,i.a)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"\u4f4d\u56fe\u548c\u4f4d\u8fd0\u7b97",children:"\u4f4d\u56fe\u548c\u4f4d\u8fd0\u7b97"}),"\n",(0,r.jsx)(e.p,{children:"\u5728\u533a\u5757\u94fe\u4e0a\u5b58\u50a8\u6570\u636e\u7684\u6210\u672c\u6781\u9ad8\u3002 \u5f88\u591a\u9879\u76ee\u521b\u65b0\u6027\u5730\u4f7f\u7528\u4e86\u4e00\u4e9b\u5de7\u5999\u7684\u65b9\u6cd5\u6765\u964d\u4f4egas\u8d39\u7528\u3002 \u6211\u4eec\u4eca\u5929\u5c06\u4f1a\u8ba8\u8bba\u90a3\u4e9b\u5e38\u89c1\u4e8e\u9f99\u5934\u9879\u76ee\u7684\u6e90\u4ee3\u7801\u4e2d\u7684\u65b9\u6cd5\u3002"}),"\n",(0,r.jsxs)(e.p,{children:["\u5bf9\u4e8e\u4e00\u4e2a ",(0,r.jsx)(e.code,{children:"uint8"})," \u7c7b\u578b\u6570\u636e\uff0c\u7528\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a ",(0,r.jsx)(e.code,{children:"00000000"}),"\uff0c\u5176\u4e2d\u6bcf\u4e2a\u4f4d\u53ef\u4ee5\u662f ",(0,r.jsx)(e.code,{children:"0"})," \u6216 ",(0,r.jsx)(e.code,{children:"1"}),"\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c",(0,r.jsx)(e.code,{children:"1"})," \u88ab\u89c6\u4e3a\u771f\uff0c",(0,r.jsx)(e.code,{children:"0"})," \u88ab\u89c6\u4e3a\u5047\u3002 \u8fd9\u79cd\u7b56\u7565\u5141\u8bb8\u901a\u8fc7\u4f4d\u8fd0\u7b97\u9ad8\u6548\u4e14\u4f4e\u6210\u672c\u5730\u7ba1\u7406\u5e03\u5c14\u503c\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:["\u5728Solidity\u4e2d\uff0c",(0,r.jsx)(e.code,{children:"1 << n"})," \u4ee3\u8868\u4e00\u4e2a\u4f4d\u79fb\u64cd\u4f5c\uff0c\u5c06\u6570\u5b57 ",(0,r.jsx)(e.code,{children:"1"})," \u5411\u5de6\u79fb\u52a8 ",(0,r.jsx)(e.code,{children:"n"})," \u4f4d\uff0c\u53f3\u4fa7\u7a7a\u51fa\u7684\u4f4d\u7528 ",(0,r.jsx)(e.code,{children:"0"})," \u586b\u5145\u3002 \u4f8b\u5982\uff0c\u5982\u679c ",(0,r.jsx)(e.code,{children:"n"})," \u662f ",(0,r.jsx)(e.code,{children:"2"}),"\uff0c\u5219 ",(0,r.jsx)(e.code,{children:"1 << 2"})," \u7684\u7ed3\u679c\u662f ",(0,r.jsx)(e.code,{children:"100"}),"\u3002"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u4ee3\u7801\u6f14\u793a"})}),"\n",(0,r.jsx)(e.p,{children:"\u4ee5\u4e0b\u6f14\u793a\u4e86\u4f7f\u7528\u5e03\u5c14\u6570\u7ec4\u548c\u4f4d\u8fd0\u7b97\u7ba1\u7406\u540c\u4e00\u6570\u636e\u7684\u65b9\u6cd5\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-solidity",children:"contract Bitmap {\n    bool[8] boolArrayImplementation;\n    uint8 bitmapImplementation;\n\n    function setBoolArrayData(bool[8] memory data) external {\n        boolArrayImplementation = data;\n    }\n\n    function setBitmapData(uint8 data) external {\n        bitmapImplementation = data;\n    }\n\n    // gas:35729\n    function readBoolArray(uint8 index) external returns (bool) {\n        return boolArrayImplementation[index];\n    }\n\n    // gas:22366\n    function readBitmap(uint indexFromRight) external returns (bool) {\n        uint256 bitAtIndex = bitmapImplementation & (1 << indexFromRight);\n        return bitAtIndex > 0;\n    }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u5728 ",(0,r.jsx)(e.code,{children:"readBitmap"})," \u51fd\u6570\u4e2d\uff0c ",(0,r.jsx)(e.code,{children:"&"})," \u6267\u884c\u4e86 ",(0,r.jsx)(e.code,{children:"bitmapImplementation"})," \u548c ",(0,r.jsx)(e.code,{children:"(1 << indexFromRight)"})," \u6bcf\u4e00\u4f4d\u4e0a\u7684 ",(0,r.jsx)(e.code,{children:"AND"})," \u64cd\u4f5c\u3002 \u53ea\u6709\u5f53\u8be5\u4f4d\u7f6e\u7684\u4e24\u4e2a\u4f4d\u90fd\u4e3a ",(0,r.jsx)(e.code,{children:"1"})," \u65f6\uff0c\u7ed3\u679c\u4f4d\u624d\u4e3a ",(0,r.jsx)(e.code,{children:"1"})," \uff0c\u5426\u5219\u4e3a ",(0,r.jsx)(e.code,{children:"0"}),"\u3002 \u8fd9\u79cd\u64cd\u4f5c\u901a\u5e38\u7528\u4e8e\u68c0\u67e5\u7279\u5b9a\u4f4d\u662f\u5426\u88ab\u8bbe\u7f6e\u4e3a ",(0,r.jsx)(e.code,{children:"1"}),"\u3002"]}),"\n",(0,r.jsx)(e.h3,{id:"gas\u4f18\u5316\u5efa\u8bae",children:"Gas\u4f18\u5316\u5efa\u8bae\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"\ud83c\udf1fConsidering practical scenarios, bitwise operators can be used for managing certain variables to save gas."})]})}function p(n={}){const{wrapper:e}={...(0,i.a)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(l,{...n})}):l(n)}},11151:(n,e,t)=>{t.d(e,{Z:()=>s,a:()=>a});var r=t(67294);const i={},o=r.createContext(i);function a(n){const e=r.useContext(o);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:a(n.components),r.createElement(o.Provider,{value:e},n.children)}}}]);