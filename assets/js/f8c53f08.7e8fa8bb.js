"use strict";(self.webpackChunkconflux_docs=self.webpackChunkconflux_docs||[]).push([[3713],{49677:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>c,toc:()=>l});var r=t(85893),o=t(11151);const a={sidebar_position:3,title:"Hardhat Conflux Plugin",description:"Tutorial for using the Hardhat Conflux Plugin",displayed_sidebar:"coreSidebar"},s=void 0,c={id:"core/tutorials/hardhat-conflux-plugin",title:"Hardhat Conflux Plugin",description:"Tutorial for using the Hardhat Conflux Plugin",source:"@site/docs/core/tutorials/hardhat-conflux-plugin.md",sourceDirName:"core/tutorials",slug:"/core/tutorials/hardhat-conflux-plugin",permalink:"/docs/core/tutorials/hardhat-conflux-plugin",draft:!1,unlisted:!1,editUrl:"https://github.com/Conflux-Chain/conflux-documentation/edit/main/docs/core/tutorials/hardhat-conflux-plugin.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Hardhat Conflux Plugin",description:"Tutorial for using the Hardhat Conflux Plugin",displayed_sidebar:"coreSidebar"},sidebar:"coreSidebar",previous:{title:"JS SDK Complete Guide",permalink:"/docs/core/tutorials/js-conflux-sdk"},next:{title:"Using ChainIDE for Smart Contract Development",permalink:"/docs/core/tutorials/chainide"}},i={},l=[{value:"Installation",id:"installation",level:2},{value:"Configuration",id:"configuration",level:2},{value:"What the Hardhat-Conflux Plugin Provides",id:"what-the-hardhat-conflux-plugin-provides",level:2},{value:"Tasks",id:"tasks",level:3},{value:"Environment Extensions",id:"environment-extensions",level:3},{value:"ConfluxSDK",id:"confluxsdk",level:4},{value:"conflux object",id:"conflux-object",level:4},{value:"Usage",id:"usage",level:2},{value:"Deploy Contract",id:"deploy-contract",level:3},{value:"Interact with Contract",id:"interact-with-contract",level:3},{value:"Verify Contract",id:"verify-contract",level:3},{value:"Complete Example",id:"complete-example",level:2},{value:"FAQs",id:"faqs",level:2},{value:"Can I use the Hardhat network to test contracts for Conflux Core?",id:"can-i-use-the-hardhat-network-to-test-contracts-for-conflux-core",level:3},{value:"Can I use the Hardhat fork feature on Conflux Core?",id:"can-i-use-the-hardhat-fork-feature-on-conflux-core",level:3},{value:"When I use helper methods in TypeScript, it shows an error like <code>Property &#39;getContractFactory&#39; does not exist on &#39;hre.conflux&#39;</code>",id:"when-i-use-helper-methods-in-typescript-it-shows-an-error-like-property-getcontractfactory-does-not-exist-on-hreconflux",level:3}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",...(0,o.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://hardhat.org/",children:"Hardhat"})," is an exceptional tool for building smart contracts. It serves as a development environment, testing framework, and asset pipeline for Ethereum-like blockchains, such as Conflux. The ",(0,r.jsx)(n.a,{href:"https://github.com/conflux-chain/hardhat-conflux",children:"Hardhat Conflux Plugin"})," adds Conflux Core Space support to Hardhat."]}),"\n",(0,r.jsx)(n.p,{children:"Developers can use Hardhat to compile Solidity code and the Hardhat-Conflux plugin to deploy, interact with, and test contracts on Core Space."}),"\n",(0,r.jsxs)(n.p,{children:["The Hardhat-Conflux plugin is built on top of ",(0,r.jsx)(n.code,{children:"js-conflux-sdk"}),", making its usage for deployment and interaction very similar to that of ",(0,r.jsx)(n.code,{children:"js-conflux-sdk"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["If you are not familiar with Hardhat, please refer to the ",(0,r.jsx)(n.a,{href:"https://hardhat.org/getting-started/",children:"Hardhat documentation"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.p,{children:"After installing Hardhat, you can install the plugin with:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm install hardhat-conflux js-conflux-sdk\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["First, import the plugin in your ",(0,r.jsx)(n.code,{children:"hardhat.config.js"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'require("hardhat-conflux");\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Or in ",(0,r.jsx)(n.code,{children:"hardhat.config.ts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'import "hardhat-conflux";\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Then, add the Conflux network to your ",(0,r.jsx)(n.code,{children:"hardhat.config.js"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'const PRIVATE_KEY = "0x0123456789012345678901234567890123456789012345678901234567890123"; // replace with your private key\nmodule.exports = {\n    defaultNetwork: "cfxTestnet",\n    networks: {\n        cfx: {\n            url: "https://main.confluxrpc.com",\n            accounts: [PRIVATE_KEY],\n            chainId: 1029,\n        },\n        cfxTestnet: {\n            url: "https://test.confluxrpc.com",\n            accounts: [PRIVATE_KEY],\n            chainId: 1,\n        },\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["If your configuration file is ",(0,r.jsx)(n.code,{children:"hardhat.config.ts"}),", the settings are similar."]}),"\n",(0,r.jsxs)(n.p,{children:["Ensure that the private key's account you use has enough balance to interact with Core Space. If not, you can use the ",(0,r.jsx)(n.a,{href:"https://faucet.confluxnetwork.org/",children:"faucet"})," to obtain some test tokens."]}),"\n",(0,r.jsx)(n.h2,{id:"what-the-hardhat-conflux-plugin-provides",children:"What the Hardhat-Conflux Plugin Provides"}),"\n",(0,r.jsx)(n.h3,{id:"tasks",children:"Tasks"}),"\n",(0,r.jsxs)(n.p,{children:["This plugin provides the ",(0,r.jsx)(n.code,{children:"verifyCfxContract"})," task, which allows you to verify contracts through ConfluxScan's service."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"npx hardhat verifyCfxContract Greeter cfxtest:acba7cvb1k6bhctzsfshybg5zgch39gnpuc8teem53\n"})}),"\n",(0,r.jsx)(n.h3,{id:"environment-extensions",children:"Environment Extensions"}),"\n",(0,r.jsx)(n.p,{children:"This plugin extends the Hardhat Runtime Environment by adding the following members:"}),"\n",(0,r.jsx)(n.h4,{id:"confluxsdk",children:"ConfluxSDK"}),"\n",(0,r.jsxs)(n.p,{children:["This is the ",(0,r.jsx)(n.code,{children:"js-conflux-sdk"})," object, which is the same as the one obtained by ",(0,r.jsx)(n.code,{children:"require('js-conflux-sdk')"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"conflux-object",children:"conflux object"}),"\n",(0,r.jsx)(n.p,{children:"A Conflux field is added to the Hardhat Runtime Environment, which is a Conflux instance automatically connected to the selected network, with extra Hardhat-specific functionality."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Get a signer array\nfunction getSigners(): Promise<ConfluxSDK.PrivateKeyAccount[]>;\n// Get js-conflux-sdk Contract Factory by name\nfunction getContractFactory(name: string): Promise<ConfluxSDK.Contract>;\n// Get js-conflux-sdk Contract Factory by ABI and bytecode\nfunction getContractFactory(abi: any[], bytecode: string): Promise<ConfluxSDK.Contract>;\n// Get js-conflux-sdk Contract instance by name and address\nfunction getContractAt(name: string, address: string): Promise<ConfluxSDK.Contract>;\n// Get js-conflux-sdk Contract instance by ABI and address\nfunction getContractAt(abi: any[], address: string): Promise<ConfluxSDK.Contract>;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(n.p,{children:"Developers can write Hardhat scripts to deploy, interact with, and test contracts on Core Space."}),"\n",(0,r.jsx)(n.h3,{id:"deploy-contract",children:"Deploy Contract"}),"\n",(0,r.jsx)(n.p,{children:"Here is a simple example of deploying a contract:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"\nasync function main() {\n    const signers = await hre.conflux.getSigners();\n    const defaultAccount = signers[0];\n\n    // Deploy the contract\n    const Greeter = await hre.conflux.getContractFactory('Greeter');\n    const receipt = await Greeter.constructor('Hello').sendTransaction({\n        from: defaultAccount.address,\n    }).executed();\n\n    console.log(`Contract deployment ${receipt.outcomeStatus === 0 ? 'succeeded' : 'failed'}`);\n    \n    if (receipt.outcomeStatus !== 0) {\n        console.log(`Error message: ${receipt.outcomeErr}`);\n        return;\n    }\n\n    const contractAddress = receipt.contract\n\nCreated;\n    console.log(`Newly deployed contract address: ${contractAddress}`);\n}\n\nmain().catch(err => {\n    console.log(err);\n    process.exit(1);\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:"Then, you can run this script with:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"npx hardhat run scripts/deploy.js --network cfxTestnet\n"})}),"\n",(0,r.jsx)(n.p,{children:"After executing the script, you can view the contract address in the console."}),"\n",(0,r.jsx)(n.h3,{id:"interact-with-contract",children:"Interact with Contract"}),"\n",(0,r.jsx)(n.p,{children:"Here is a simple example of interacting with a contract:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"async function main() {\n    const signers = await hre.conflux.getSigners();\n    const defaultAccount = signers[0];\n    const contractAddress = 'cfxtest:acba7cvb1k6bhctzsfshybg5zgch39gnpuc8teem53'; // replace with your contract address\n    \n    // Get the contract instance\n    const greeter = await hre.conflux.getContractAt('Greeter', contractAddress);\n    \n    // Read the contract state\n    const greet = await greeter.greet();\n    \n    // Update the contract state by sending a transaction\n    const receipt = await greeter.setGreeting('new greet').sendTransaction({\n        from: defaultAccount.address,\n    }).executed();\n    console.log('Update contract state transaction hash: ', receipt.transactionHash);\n}\n\nmain().catch(err => {\n    console.log(err);\n    process.exit(1);\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:"Then, you can run this script with:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"npx hardhat run scripts/interact.js --network cfxTestnet\n"})}),"\n",(0,r.jsx)(n.h3,{id:"verify-contract",children:"Verify Contract"}),"\n",(0,r.jsxs)(n.p,{children:["Use the ",(0,r.jsx)(n.strong,{children:"verifyCfxContract"})," task to verify contracts through ConfluxScan's service."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"npx hardhat verifyCfxContract Greeter cfxtest:acba7cvb1k6bhctzsfshybg5zgch39gnpuc8teem53\n"})}),"\n",(0,r.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,r.jsxs)(n.p,{children:["A complete example is available at ",(0,r.jsx)(n.a,{href:"https://github.com/Conflux-Chain/hardhat-conflux-example",children:"hardhat-conflux-example"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"faqs",children:"FAQs"}),"\n",(0,r.jsx)(n.h3,{id:"can-i-use-the-hardhat-network-to-test-contracts-for-conflux-core",children:"Can I use the Hardhat network to test contracts for Conflux Core?"}),"\n",(0,r.jsxs)(n.p,{children:["If your contracts do not use any Conflux-specific features (like Internal Contracts, 1820, create2), you can use the Hardhat network to test your contracts. For the VM differences between the Hardhat network and Conflux Core, please refer to ",(0,r.jsx)(n.a,{href:"/docs/core/core-space-basics/vm-difference",children:"VM differences"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"can-i-use-the-hardhat-fork-feature-on-conflux-core",children:"Can I use the Hardhat fork feature on Conflux Core?"}),"\n",(0,r.jsx)(n.p,{children:"No. The Hardhat fork feature is not supported on Conflux Core."}),"\n",(0,r.jsxs)(n.h3,{id:"when-i-use-helper-methods-in-typescript-it-shows-an-error-like-property-getcontractfactory-does-not-exist-on-hreconflux",children:["When I use helper methods in TypeScript, it shows an error like ",(0,r.jsx)(n.code,{children:"Property 'getContractFactory' does not exist on 'hre.conflux'"})]}),"\n",(0,r.jsxs)(n.p,{children:["Currently, this plugin does not provide TypeScript type definitions. You can use ",(0,r.jsx)(n.code,{children:"// @ts-ignore"})," to suppress the error message; it will not affect the code's execution. We plan to provide TypeScript type definitions in the future."]})]})}function h(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>c,a:()=>s});var r=t(67294);const o={},a=r.createContext(o);function s(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);